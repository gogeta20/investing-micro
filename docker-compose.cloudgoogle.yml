version: '3.9'

services:
    rabbitmq:
        build:
            context: .
            dockerfile: devops/dockerfiles/broker/RabbitMQ.Dockerfile
        container_name: rabbitmq
        ports:
            - "15672:15672"  # Puerto para el panel de administraci√≥n
            - "5672:5672"     # Puerto para las conexiones de los clientes
        environment:
            RABBITMQ_DEFAULT_USER: admin
            RABBITMQ_DEFAULT_PASS: your_password
        healthcheck:
            test: ["CMD", "rabbitmqctl", "status"]
            interval: 10s
            timeout: 5s
            retries: 5
        networks:
            - app_network
        profiles:
            - local
    nginx_proxy:
        build:
            context: .
            dockerfile: devops/dockerfiles/proxy/Nginx.Dockerfile
        container_name: nginx_proxy
        #    volumes:
        #      - ./conf/nginx/nginx.conf:/etc/nginx/nginx.conf
        volumes:
            - ./conf/nginx:/src
        ports:
            - "80:80"
        # depends_on:
            # - symfony_backend
            # - django_backend
            # - springboot_backend
            # - front_micro
        networks:
            - app_network
        profiles:
            - local

networks:
    app_network:
        driver: bridge
